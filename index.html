<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ä¸–ç•Œä¸Šæœ€å¿§éƒçš„ç½‘ç«™</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  background:#000;
  font-family:Arial,sans-serif;
  overflow:hidden;
}
body.normal{
  background:linear-gradient(135deg,#ff9a9e 0%,#fecfef 50%,#fecfef 100%);
}
body.horror{background:#000}
body.flash{animation:flash 0.12s infinite alternate}
@keyframes flash{0%{background:#000}100%{background:#1a0000}}

body.final_glitch {
  animation:final_glitch 0.04s infinite alternate !important;
}
@keyframes final_glitch {
  0%{background:#000; filter:contrast(1.5) saturate(2);}
  50%{background:#200000; filter:contrast(2) saturate(3);}
  100%{background:#000; filter:contrast(1.5) saturate(2);}
}

h1{
  font-size:clamp(2rem, 8vw, 4rem);
  color:#8B4513;
  margin-bottom:2rem;
  text-align:center;
}
body.horror h1{
  color:#ff2222;
  text-shadow:0 0 10px red;
}

.emoji{
  font-size:clamp(4rem,16vw,8rem);
  cursor:pointer;
  margin-bottom:2rem;
}
body.horror .emoji{
  filter:brightness(0.1) sepia(1) saturate(10);
}

#tip{
  font-size:clamp(1rem,4vw,22px);
  color:#fff;
  background:rgba(0,0,0,0.3);
  padding:10px 20px;
  border-radius:16px;
}
body.horror #tip{
  color:#ff4444;
}

#fullVideo{
  position:fixed;
  top:0;left:0;
  width:100vw;height:100vh;
  object-fit:cover;
  z-index:9999;
  display:none;
}

.warning{
  position:fixed;
  color:red;
  font-size:32px;
  z-index:100;
}
</style>
</head>
<body class="normal">

<h1>æ­å–œä½ æ‰¾åˆ°äº†å¤§ä¾¿ğŸ’©</h1>
<div class="emoji" id="poop">ğŸ’©</div>
<div id="tip">å†ç‚¹ 10 ä¸‹æœ‰æƒŠå–œï¼</div>

<video id="fullVideo"></video>

<audio id="aSound" src="a.mp3">
<audio id="bSound" src="b.mp3">
<audio id="ambient" src="ambient.mp3" loop>

<script>
const IS_HORROR = Math.random() < 0.3;

const body = document.body;
const poop = document.getElementById("poop");
const tip = document.getElementById("tip");
const fullVideo = document.getElementById("fullVideo");

const aSound = document.getElementById("aSound");
const bSound = document.getElementById("bSound");
const ambient = document.getElementById("ambient");

let state = {
  videoPlaying: false,
  normal: { count:0, canClick:true },
  horror: { count:0, canClick:true, first:true }
};

// åˆå§‹åŒ–
window.onload = function(){
  if(IS_HORROR){
    body.classList.remove("normal");
    body.classList.add("horror");
    tip.innerText = "ä¸å¯ä»¥ç©åŸç¥";
  }
};

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” æ­£å¸¸æ¨¡å¼ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
function normalClick(){
  if(!state.normal.canClick) return;

  aSound.currentTime = 0;
  aSound.volume = 0.5;
  aSound.play();

  state.normal.canClick = false;
  setTimeout(()=>{ state.normal.canClick = true }, 1000);

  state.normal.count++;
  let left = 10 - state.normal.count;
  if(left > 0){
    tip.innerText = `å†ç‚¹ ${left} ä¸‹æœ‰æƒŠå–œï¼`;
    return;
  }

  tip.innerText = "ğŸ‰ æƒŠå–œæ¥äº†ï¼";
  state.normal.count = 0;
  window.open("https://ys.mihoyo.com/");
  setTimeout(()=>{ tip.innerText = "å†ç‚¹ 10 ä¸‹æœ‰æƒŠå–œï¼" },1000);
}

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ææ€–æ¨¡å¼ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
function horrorClick(){
  if(state.videoPlaying || !state.horror.canClick) return;

  if(state.horror.first){
    state.horror.first = false;
    state.videoPlaying = true;

    ambient.volume = 0.25;
    ambient.play();

    fullVideo.src = "2.mp4";
    fullVideo.style.display = "block";
    fullVideo.play();

    fullVideo.onended = function(){
      fullVideo.style.display = "none";
      state.videoPlaying = false;
      tip.innerText = "è¿˜å‰© 10 æ¬¡";
    };
    return;
  }

  if(state.horror.count >= 10){
    ambient.pause();
    window.open("https://mc.kurogames.com/m/");
    return;
  }

  state.horror.canClick = false;
  setTimeout(()=>{ state.horror.canClick = true },3000);

  let s = bSound.cloneNode(true);
  s.volume = 1;
  s.currentTime = 0;
  s.play();

  state.horror.count++;
  let r = 10 - state.horror.count;
  tip.innerText = "è¿˜å‰© "+r+" æ¬¡";

  if(r === 1) body.classList.add("final_glitch");

  if(state.horror.count ===5){
    state.videoPlaying = true;
    fullVideo.src = "3.mp4";
    fullVideo.style.display = "block";
    fullVideo.play();
    fullVideo.onended = ()=>{
      fullVideo.style.display = "none";
      state.videoPlaying = false;
    };
  }
}

// â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç»Ÿä¸€ç‚¹å‡»ï¼ˆæœ€ç¨³å†™æ³•ï¼‰ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
poop.onclick = function(){
  if(IS_HORROR) {
    horrorClick();
  } else {
    normalClick();
  }
};
</script>
</body>
</html>
