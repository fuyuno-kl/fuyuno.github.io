<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ä¸–ç•Œä¸Šæœ€å¿§éƒçš„ç½‘ç«™</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  min-height:100vh;
  display:flex;
  flex-direction: column;
  justify-content:center;
  align-items:center;
  background:#000;
  font-family:Arial,sans-serif;
  overflow:hidden;
}
body.normal{
  background:linear-gradient(135deg,#ff9a9e 0%,#fecfef 50%,#fecfef 100%);
}
body.horror{background:#000}
body.flash{animation:flash 0.12s infinite alternate}
@keyframes flash{0%{background:#000}100%{background:#1a0000}}

body.final_glitch {
  animation: final_glitch 0.04s infinite alternate !important;
}
@keyframes final_glitch {
  0%{background:#000; filter:contrast(1.5) saturate(2) hue-rotate(0deg);}
  50%{background:#200000; filter:contrast(2) saturate(3) hue-rotate(10deg);}
  100%{background:#000; filter:contrast(1.5) saturate(2) hue-rotate(0deg);}
}

/* æµè§ˆå™¨æç¤ºæ¡ */
#browserTip {
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.6);
  color: #fff;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 14px;
  z-index: 99999;
  opacity: 0.8;
}

h1{
  font-size:4rem;
  color:#8B4513;
  text-shadow:3px 3px 0 #fff,6px 6px 0 rgba(0,0,0,0.2);
  animation:bounce 1s infinite alternate;
  margin-bottom: 2rem;
  text-align:center;
}
body.horror h1{
  color:#ff2222;
  text-shadow:0 0 10px red;
  animation:horrorBounce 0.3s infinite alternate;
}
@keyframes bounce{from{transform:translateY(0)}to{transform:translateY(-20px)} }
@keyframes horrorBounce{from{transform:translateY(0)}to{transform:translateY(-8px)} }

.emoji{
  font-size:8rem;
  animation:rotate 3s linear infinite;
  cursor:pointer;
  margin-bottom: 2rem;
  display:block;
  position:relative;
  z-index:9999;
}
body.horror .emoji{
  filter:brightness(0.1) sepia(1) saturate(10);
}
@keyframes rotate{from{transform:rotate(0deg)}to{transform:rotate(360deg)} }

@keyframes shake{
  0%{transform:rotate(0deg) translate(0,0)}
  20%{transform:rotate(-2deg) translate(-2px,2px)}
  40%{transform:rotate(2deg) translate(2px,-2px)}
  60%{transform:rotate(-2deg) translate(2px,2px)}
  80%{transform:rotate(2deg) translate(-2px,-2px)}
  100%{transform:rotate(0deg) translate(0,0)}
}
.emoji.shake{animation:shake 0.2s ease}

#tip{
  font-size:22px;
  color:#fff;
  background:rgba(0,0,0,0.3);
  padding:10px 20px;
  border-radius:16px;
  text-align:center;
}
body.horror #tip{
  color:#ff4444;
  background:rgba(20,0,0,0.8);
}

#fullVideo{
  position:fixed;
  top:0;left:0;
  width:100vw;height:100vh;
  object-fit:cover;
  z-index:9999;
  display:none;
}

.warning{
  position:fixed;
  color:red;
  font-size:32px;
  z-index:100;
}
</style>
</head>
<body class="normal">

<!-- æµè§ˆå™¨æ£€æµ‹æç¤º -->
<div id="browserTip"></div>

<h1>æ­å–œä½ æ‰¾åˆ°äº†å¤§ä¾¿ğŸ’©</h1>
<div class="emoji" id="poop">ğŸ’©</div>
<div id="tip">å†ç‚¹ 10 ä¸‹æœ‰æƒŠå–œï¼</div>

<video id="fullVideo"></video>

<audio id="aSound" src="a.mp3">
<audio id="bSound" src="b.mp3">
<audio id="ambient" src="ambient.mp3" loop>

<script>
// ====================== æµè§ˆå™¨è‡ªåŠ¨æ£€æµ‹æç¤º ======================
const ua = navigator.userAgent.toLowerCase();
let tipText = "å·²é€‚é…å…¨æµè§ˆå™¨";
if (ua.includes("via")) tipText = "âœ… VIA æµè§ˆå™¨ Â· å·²é€‚é…";
else if (ua.includes("quark")) tipText = "âœ… å¤¸å…‹æµè§ˆå™¨ Â· å·²é€‚é…";
else if (ua.includes("chrome")) tipText = "âœ… Chrome æµè§ˆå™¨ Â· å·²é€‚é…";
else if (ua.includes("firefox")) tipText = "âœ… Firefox æµè§ˆå™¨ Â· å·²é€‚é…";
else if (ua.includes("safari")) tipText = "âœ… Safari æµè§ˆå™¨ Â· å·²é€‚é…";
else if (ua.includes("qqbrowser")) tipText = "âœ… QQ æµè§ˆå™¨ Â· å·²é€‚é…";
else if (ua.includes("micromessenger")) tipText = "âœ… å¾®ä¿¡å†…ç½®æµè§ˆå™¨ Â· å·²é€‚é…";

document.getElementById("browserTip").innerText = tipText;

// ====================== ä¸»é€»è¾‘ ======================
const IS_HORROR = Math.random() < 0.3;

const body = document.body;
const poop = document.getElementById("poop");
const tip = document.getElementById("tip");
const fullVideo = document.getElementById("fullVideo");

const aSound = document.getElementById("aSound");
const bSound = document.getElementById("bSound");
const ambient = document.getElementById("ambient");

let state = {
  videoPlaying: false,
  normal: { count:0, canClick:true },
  horror: { count:0, canClick:true, first:true }
};

window.onload = function(){
  if(IS_HORROR){
    body.classList.remove("normal");
    body.classList.add("horror");
    tip.innerText = "ä¸å¯ä»¥ç©åŸç¥";
  }
};

// æ­£å¸¸æ¨¡å¼
function normalClick(){
  if(!state.normal.canClick) return;

  poop.classList.add('shake');
  setTimeout(()=>poop.classList.remove('shake'),200);

  aSound.currentTime = 0;
  aSound.volume = 0.5;
  aSound.play().catch(()=>{});

  state.normal.canClick = false;
  setTimeout(()=>{ state.normal.canClick = true },1000);

  state.normal.count++;
  let left = 10 - state.normal.count;
  if(left>0){
    tip.innerText = `å†ç‚¹ ${left} ä¸‹æœ‰æƒŠå–œï¼`;
    return;
  }

  tip.innerText = "ğŸ‰ æƒŠå–œæ¥äº†ï¼";
  state.normal.count = 0;
  window.open("https://ys.mihoyo.com/","_blank");
  setTimeout(()=>{ tip.innerText = "å†ç‚¹ 10 ä¸‹æœ‰æƒŠå–œï¼" },1000);
}

// ææ€–æ¨¡å¼
function horrorClick(){
  if(state.videoPlaying || !state.horror.canClick) return;

  poop.classList.add('shake');
  setTimeout(()=>poop.classList.remove('shake'),200);

  if(state.horror.first){
    state.horror.first = false;
    state.videoPlaying = true;

    ambient.volume = 0.25;
    ambient.play().catch(()=>{});

    fullVideo.src = "2.mp4";
    fullVideo.style.display = "block";
    fullVideo.play().catch(()=>{});

    fullVideo.onended = function(){
      fullVideo.style.display = "none";
      state.videoPlaying = false;
      tip.innerText = "è¿˜å‰© 10 æ¬¡";
    };
    return;
  }

  if(state.horror.count >=10){
    ambient.pause();
    window.open("https://mc.kurogames.com/m/","_blank");
    return;
  }

  state.horror.canClick = false;
  setTimeout(()=>{ state.horror.canClick = true },3000);

  let s = bSound.cloneNode(true);
  s.volume = 1;
  s.currentTime = 0;
  s.play().catch(()=>{});

  state.horror.count++;
  let r = 10 - state.horror.count;
  tip.innerText = "è¿˜å‰© "+r+" æ¬¡";

  if(r === 1) body.classList.add("final_glitch");

  if(state.horror.count ===5){
    state.videoPlaying = true;
    fullVideo.src = "3.mp4";
    fullVideo.style.display = "block";
    fullVideo.play().catch(()=>{});
    fullVideo.onended = ()=>{
      fullVideo.style.display = "none";
      state.videoPlaying = false;
    };
  }
}

// å…¨å¹³å°ç‚¹å‡»
poop.onclick = function(){
  if(IS_HORROR) horrorClick();
  else normalClick();
};
poop.ontouchstart = function(e){
  e.preventDefault();
  if(IS_HORROR) horrorClick();
  else normalClick();
};
</script>
</body>
</html>
